<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Integrated Analysis of Microbial Community Assembly with MbioAssy 2.0 • MbioAssy2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Integrated Analysis of Microbial Community Assembly with MbioAssy 2.0">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MbioAssy2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/MbioAssy_vignette.html">Integrated Analysis of Microbial Community Assembly with MbioAssy 2.0</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Integrated Analysis of Microbial Community Assembly with MbioAssy 2.0</h1>
                        <h4 data-toc-skip class="author">Ling Yuan, Ze
Zhao, Feng Ju</h4>
            
            <h4 data-toc-skip class="date">2025-12-15</h4>
      

      <div class="d-none name"><code>MbioAssy_vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>MbioAssy</strong> provides an integrated pipeline for
assessing ecological stochasticity and determinism in microbial
community assembly. This vignette demonstrates how to use the package to
perform:</p>
<ol style="list-style-type: decimal">
<li>Normalized Stochasticity Ratio (NST) analysis</li>
<li>Neutral Model analysis</li>
<li>iCAMP (infer Community Assembly Mechanisms by Phylogenetic-bin-based
null model) analysis</li>
<li>C-score variance analysis</li>
<li>Co-occurrence Network construction and topology analysis</li>
</ol>
</div>
<div class="section level2">
<h2 id="loading-data">Loading Data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h2>
<p>The package includes example data in the <code>inst/extdata</code>
directory. We first load the necessary data tables.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MbioAssy2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's assume we are running this where we can access the files.</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"MbioAssy2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load OTU table</span></span>
<span><span class="va">otu_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"OTU.txt"</span><span class="op">)</span></span>
<span><span class="va">otu_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">otu_file</span>, sep <span class="op">=</span> <span class="st">" "</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># Samples x OTUs</span></span>
<span></span>
<span><span class="co"># Filter</span></span>
<span><span class="va">otu_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">otu_table</span><span class="op">)</span></span>
<span><span class="va">otu_table</span> <span class="op">&lt;-</span> <span class="va">otu_table</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">otu_table</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">otu_table</span> <span class="op">&lt;-</span> <span class="va">otu_table</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">otu_table</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Load Group table</span></span>
<span><span class="va">group_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"Group.txt"</span><span class="op">)</span></span>
<span><span class="va">group_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">group_file</span>, sep <span class="op">=</span> <span class="st">"   "</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load Tree</span></span>
<span><span class="va">tree_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"Tree.nwk"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ape"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="va">tree_file</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Load Env</span></span>
<span><span class="va">env_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"Env.txt"</span><span class="op">)</span></span>
<span><span class="va">env_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">env_file</span>, sep <span class="op">=</span> <span class="st">"   "</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load Taxonomy</span></span>
<span><span class="va">tax_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"Taxonomy.txt"</span><span class="op">)</span></span>
<span><span class="va">tax_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">tax_file</span>, sep <span class="op">=</span> <span class="st">"   "</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normalized-stochasticity-ratio-nst-analysis">1. Normalized Stochasticity Ratio (NST) Analysis<a class="anchor" aria-label="anchor" href="#normalized-stochasticity-ratio-nst-analysis"></a>
</h2>
<p>NST quantifies stochasticity in community assembly. NST &gt; 0.5
indicates stochasticity dominance; NST &lt; 0.5 indicates determinism
dominance.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run NST (rand=20 for speed in vignette, normally 1000)</span></span>
<span><span class="va">nst_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_nst.html">run_nst</a></span><span class="op">(</span></span>
<span>  comm <span class="op">=</span> <span class="va">otu_table</span>, </span>
<span>  group <span class="op">=</span> <span class="va">group_table</span>, </span>
<span>  rand <span class="op">=</span> <span class="fl">20</span>, </span>
<span>  output_file <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; All match very well.</span></span>
<span><span class="co">#&gt; Now randomizing by parallel computing. Begin at Mon Dec 15 17:53:50 2025. Please wait...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nst_res</span><span class="op">)</span></span>
<span><span class="co">#&gt;             group size ST.i.ruzicka NST.i.ruzicka MST.i.ruzicka</span></span>
<span><span class="co">#&gt; 1 Non-saline soil  435    0.7610271     0.4062123     0.3729465</span></span>
<span><span class="co">#&gt; 2     Saline soil 1770    0.8274543     0.4843195     0.4459306</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="neutral-model-analysis">2. Neutral Model Analysis<a class="anchor" aria-label="anchor" href="#neutral-model-analysis"></a>
</h2>
<p>This module fits the Sloan neutral community model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit neutral model</span></span>
<span><span class="va">nm_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_sncm.html">fit_sncm</a></span><span class="op">(</span>spp <span class="op">=</span> <span class="va">otu_table</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span></span>
<span><span class="co"># Plot results</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_sncm_fit.html">plot_sncm_fit</a></span><span class="op">(</span><span class="va">nm_out</span>, title <span class="op">=</span> <span class="st">"Neutral Model Fit"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="MbioAssy_vignette_files/figure-html/neutral_model-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Inspect fit statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">nm_out</span><span class="op">$</span><span class="va">fitstats</span><span class="op">)</span></span>
<span><span class="co">#&gt;           m       m.ci    poisLL      Rsqr  Rsqr.pois      RMSE RMSE.pois</span></span>
<span><span class="co">#&gt; 1 0.2096662 0.01067895 -1133.184 0.6689915 0.02138333 0.1513549 0.2602456</span></span>
<span><span class="co">#&gt;    AIC.pois  BIC.pois        N Samples Richness       Detect</span></span>
<span><span class="co">#&gt; 1 -2262.368 -2250.356 9782.911      90     3000 0.0001022191</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="icamp-analysis">3. iCAMP Analysis<a class="anchor" aria-label="anchor" href="#icamp-analysis"></a>
</h2>
<p>iCAMP quantifies relative importance of ecological processes
(Selection, Dispersal, Drift) at the bin level.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create a temporary directory for outputs</span></span>
<span><span class="va">icamp_out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">icamp_out_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run iCAMP (parameters reduced for speed)</span></span>
<span><span class="va">icamp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_icamp.html">run_icamp</a></span><span class="op">(</span></span>
<span>  comm <span class="op">=</span> <span class="va">otu_table</span>,</span>
<span>  tree <span class="op">=</span> <span class="va">tree</span>,</span>
<span>  treat <span class="op">=</span> <span class="va">group_table</span>,</span>
<span>  env <span class="op">=</span> <span class="va">env_table</span>,</span>
<span>  clas <span class="op">=</span> <span class="va">tax_table</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"VignetteTest"</span>,</span>
<span>  save_dir <span class="op">=</span> <span class="va">icamp_out_dir</span>,</span>
<span>  rand <span class="op">=</span> <span class="fl">20</span>,         <span class="co"># 1000 recommended</span></span>
<span>  nworker <span class="op">=</span> <span class="fl">2</span>,       <span class="co"># Adjust based on CPU</span></span>
<span>  bin_size_limit <span class="op">=</span> <span class="fl">12</span> <span class="co"># Small for test data</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "9.582236 mins"</span></span>
<span></span>
<span><span class="co"># View process importance for each group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">icamp_res</span><span class="op">$</span><span class="va">icbin</span><span class="op">$</span><span class="va">Pt</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Method GroupBasedOn                          Group                HeS</span></span>
<span><span class="co">#&gt; 1 CbMPDiCbraya       Saline                Non-saline soil 0.0123098029312797</span></span>
<span><span class="co">#&gt; 2 CbMPDiCbraya       Saline                    Saline soil  0.014165570010395</span></span>
<span><span class="co">#&gt; 3 CbMPDiCbraya       Saline Non-saline soil_vs_Saline soil 0.0206792474744961</span></span>
<span><span class="co">#&gt;                 HoS                DL                 HD                DR</span></span>
<span><span class="co">#&gt; 1 0.283503111381944 0.497525614644261  0.058154511964781 0.148506959077734</span></span>
<span><span class="co">#&gt; 2 0.264772543226473 0.425054980449691 0.0855917551317241 0.210415151181717</span></span>
<span><span class="co">#&gt; 3  0.24006506028654 0.515761262146708 0.0481255058329052  0.17536892425935</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="c-score-variance-analysis">4. C-score Variance Analysis<a class="anchor" aria-label="anchor" href="#c-score-variance-analysis"></a>
</h2>
<p>C-score variance assesses co-occurrence patterns (aggregation
vs. segregation).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run C-score analysis (nReps reduced for speed)</span></span>
<span><span class="va">cscore_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_cscore_var.html">run_cscore_var</a></span><span class="op">(</span></span>
<span>  comm <span class="op">=</span> <span class="va">otu_table</span>,</span>
<span>  nReps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  save_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_file <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Burn-in Progress </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Swap Progress </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cscore_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time Stamp:  Mon Dec 15 18:06:23 2025 </span></span>
<span><span class="co">#&gt; Reproducible:  </span></span>
<span><span class="co">#&gt; Number of Replications:  </span></span>
<span><span class="co">#&gt; Elapsed Time:  2.3 mins </span></span>
<span><span class="co">#&gt; Metric:  c_score_var </span></span>
<span><span class="co">#&gt; Algorithm:  sim9 </span></span>
<span><span class="co">#&gt; Observed Index:  26174 </span></span>
<span><span class="co">#&gt; Mean Of Simulated Index:  25257 </span></span>
<span><span class="co">#&gt; Variance Of Simulated Index:  839.67 </span></span>
<span><span class="co">#&gt; Lower 95% (1-tail):  25209 </span></span>
<span><span class="co">#&gt; Upper 95% (1-tail):  25309 </span></span>
<span><span class="co">#&gt; Lower 95% (2-tail):  25208 </span></span>
<span><span class="co">#&gt; Upper 95% (2-tail):  25310 </span></span>
<span><span class="co">#&gt; Lower-tail P &gt;  0.99 </span></span>
<span><span class="co">#&gt; Upper-tail P &lt;  0.01 </span></span>
<span><span class="co">#&gt; Observed metric &gt; 100 simulated metrics </span></span>
<span><span class="co">#&gt; Observed metric &lt; 0 simulated metrics </span></span>
<span><span class="co">#&gt; Observed metric = 0 simulated metrics </span></span>
<span><span class="co">#&gt; Standardized Effect Size (SES):  31.639</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="co-occurrence-network-analysis">5. Co-occurrence Network Analysis<a class="anchor" aria-label="anchor" href="#co-occurrence-network-analysis"></a>
</h2>
<p>Constructs and analyzes microbial interaction networks.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct network</span></span>
<span><span class="co"># For demonstration, we use a simple Spearman correlation without RMT</span></span>
<span><span class="va">net_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_network.html">construct_network</a></span><span class="op">(</span></span>
<span>  comm <span class="op">=</span> <span class="va">otu_table</span>,</span>
<span>  cor_cutoff <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  use_rmt <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate topology</span></span>
<span><span class="va">topo_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_topology.html">calculate_topology</a></span><span class="op">(</span><span class="va">net_res</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net_res</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span></span></code></pre></div>
<p><img src="MbioAssy_vignette_files/figure-html/network_analysis-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Global topology</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">topo_res</span><span class="op">$</span><span class="va">global</span><span class="op">)</span></span>
<span><span class="co">#&gt;      e    v        cc      spl        md          gd nd       ad</span></span>
<span><span class="co">#&gt; 1 4327 1007 0.3589672 3.170335 0.6309238 0.008542588 15 8.593843</span></span>
<span></span>
<span><span class="co"># Top 5 nodes by degree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">topo_res</span><span class="op">$</span><span class="va">node</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">topo_res</span><span class="op">$</span><span class="va">node</span><span class="op">$</span><span class="va">node.degree</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         node.degree betweenness.centrality closeness.centrality</span></span>
<span><span class="co">#&gt; OTU_52           87              29394.223         0.0003423485</span></span>
<span><span class="co">#&gt; OTU_19           72               7612.059         0.0003060912</span></span>
<span><span class="co">#&gt; OTU_55           71              21715.277         0.0003332223</span></span>
<span><span class="co">#&gt; OTU_137          67               7162.284         0.0002935134</span></span>
<span><span class="co">#&gt; OTU_150          66               9532.687         0.0003327787</span></span>
<span><span class="co">#&gt; OTU_106          64               5577.901         0.0002928258</span></span>
<span><span class="co">#&gt;         node.transitivity</span></span>
<span><span class="co">#&gt; OTU_52          0.2173216</span></span>
<span><span class="co">#&gt; OTU_19          0.2879499</span></span>
<span><span class="co">#&gt; OTU_55          0.2406439</span></span>
<span><span class="co">#&gt; OTU_137         0.2786070</span></span>
<span><span class="co">#&gt; OTU_150         0.2442890</span></span>
<span><span class="co">#&gt; OTU_106         0.2901786</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="random-network-generation">6. Random Network Generation<a class="anchor" aria-label="anchor" href="#random-network-generation"></a>
</h2>
<p>Generates random networks to compare with the empirical network.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate 10 random networks with same nodes and edges as empirical network</span></span>
<span><span class="va">n_nodes</span> <span class="op">&lt;-</span> <span class="va">topo_res</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">v</span></span>
<span><span class="va">n_edges</span> <span class="op">&lt;-</span> <span class="va">topo_res</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">e</span></span>
<span></span>
<span><span class="va">rand_net_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_random_networks.html">generate_random_networks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_nodes</span>, e <span class="op">=</span> <span class="va">n_edges</span>, reps <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rand_net_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt;      n    e          cc      spl        md          gd nd       ad</span></span>
<span><span class="co">#&gt; 1 1007 4327 0.009153196 3.458105 0.2490601 0.008542588  6 8.593843</span></span>
<span><span class="co">#&gt; 2 1007 4327 0.008691453 3.453841 0.2564205 0.008542588  6 8.593843</span></span>
<span><span class="co">#&gt; 3 1007 4327 0.009366092 3.458490 0.2571868 0.008542588  6 8.593843</span></span>
<span><span class="co">#&gt; 4 1007 4327 0.009021587 3.457938 0.2578211 0.008542588  6 8.593843</span></span>
<span><span class="co">#&gt; 5 1007 4327 0.009301331 3.457529 0.2560048 0.008542588  7 8.593843</span></span>
<span><span class="co">#&gt; 6 1007 4327 0.007913224 3.454889 0.2501405 0.008542588  6 8.593843</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>MbioAssy</code> package simplifies the complex workflow of
microbial community assembly analysis, making these advanced ecological
methods more accessible.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ling Yuan, Ze Zhao, Feng Ju.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
